Contactables = new Meteor.Collection("contactables");

Meteor.publish('contactables', function () {
	var user = Meteor.users.findOne({
		_id: this.userId
	});

	if (!user)
		return false;

	return Contactables.find({
		hierId: user.hierId
	});
})

Meteor.startup(function () {
	Meteor.methods({
		addContactable: function (contactable) {
			var user = Meteor.user();
			if (user == null)
				throw new Meteor.Error(401, "Please login");

			addSystemMetadata(contactable, user);

			Contactables.insert(contactable);
		}
	});
});

Contactables.allow({
<<<<<<< HEAD
	update: function () {
		return true;
	}
})
=======
    update: function () {
        return true;
    }
});
>>>>>>> 21488dfb5a2da0ddfa637f120eb9eb6d8552b4c2
