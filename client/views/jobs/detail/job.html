<template name="job">
    <div class="contactable-page-details" name="jobVM">
        <div id="content">
            {{#with originalJob}}
                <div id="content-header" class="mini">
                    <h1 class="profile-name">{{displayName}}
                    <a class="pull-right" href="/contactable/{{customer}}">
                        <i class="icon-buildings-1"></i>
                        {{customerName}}
                    </a>
                    </h1>
                </div>
                <div id="breadcrumb" class="breadcrumb-top">
                    <a href="/" title="Go to Home" class="tip-bottom">
                        <i class="fa fa-home"></i>Home</a>
                    <a href="/jobs" class="current">Jobs</a>
                </div>
            {{/with}}

            {{#with job}}
                <div class="container-fluid contactable-content">
                    <div class="row">
                        <!-- Left Column -->
                        <div class="col-sm-6 col-lg-8 contactable-right-col-custom has-tabs">
                            <div class="box">
                                <div class="box-header-2">
                                    <a class="btn-action editJob pull-right" href="#" style="color: {{colorEdit}}"><i class="fa fa-pencil"></i></a>
                                    <div class="box-title">Job Details</div>
                                </div>
                                <div class="box-body">
                                    <table class="table custom-table text-normal" style="table-layout: fixed;">
                                        <tbody>

                                            <tr>
                                                <td>
                                                    <i class="fa fa-briefcase"></i>&nbsp;Job title:
                                                    {{#objectProperty property=publicJobTitle editable=editMode}}
                                                        <input class="form-control" type="text" value="{{value}}">
                                                    {{else}}
                                                        <strong>{{value}}</strong>
                                                    {{/objectProperty}}
                                                </td>
                                                <td>
                                                    <i class="fa fa-globe"></i>&nbsp;Location:
                                                    {{#if editMode}}
                                                        {{#inputLocation location}}
                                                        {{/inputLocation}}
                                                    {{else}}
                                                        {{#with location.value}}
                                                            <strong>{{displayName}}</strong>
                                                        {{else}}
                                                            <strong class="text-muted">Not set</strong>
                                                        {{/with}}
                                                    {{/if}}
                                                </td>
                                            </tr>

                                            <tr>
                                                <td>
                                                    <i class="fa fa-calendar"></i>&nbsp;Start date:
                                                    {{#objectProperty property=startDate editable=editMode}}
                                                            {{#dateTimePicker value=value}}
                                                            {{/dateTimePicker}}
                                                    {{else}}
                                                        <strong>
                                                            {{#formattedDate value=value format='MM.DD.YYYY'}}
                                                                {{date}}
                                                            {{/formattedDate}}
                                                        </strong>
                                                    {{/objectProperty}}
                                                </td>
                                                <td>
                                                    <i class="fa fa-calendar"></i>&nbsp;End date:
                                                    {{#objectProperty property=endDate editable=editMode}}
                                                        {{#dateTimePicker value=value}}
                                                        {{/dateTimePicker}}
                                                    {{else}}
                                                        <strong>
                                                            {{#if value}}
                                                                {{#formattedDate value=value format='MM.DD.YYYY'}}
                                                                {{date}}
                                                                {{/formattedDate}}
                                                            {{else}}
                                                                Not set
                                                            {{/if}}
                                                        </strong>
                                                    {{/objectProperty}}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <i class="fa fa-clock-o"></i>&nbsp;Duration:
                                                    {{#objectProperty property=duration editable=editMode}}
                                                        <div class="form-group  {{hasError}}">
                                                            <select class="form-control input-lg">
                                                                {{#each options}}
                                                                    <option value="{{_id}}" selected="{{isSelected _id ../value}}" disabled="{{inactive}}">{{displayName}}</option>
                                                                {{/each}}
                                                            </select>
                                                            <span>{{error}}</span>
                                                        </div><!-- /.form-group -->
                                                    {{else}}
                                                        <strong>
                                                            <strong>{{displayName}}</strong>
                                                        </strong>
                                                    {{/objectProperty}}
                                                </td>
                                                <td>
                                                    <i class="fa fa-info-circle"></i>&nbsp;Status:

                                                    {{#objectProperty property=status editable=editMode}}
                                                        <div class="form-group  {{hasError}}">
                                                            <select class="form-control input-lg">
                                                                {{#each options}}
                                                                    <option value="{{_id}}" selected="{{isSelected _id ../value}}" disabled="{{inactive}}">{{displayName}}</option>
                                                                {{/each}}
                                                            </select>
                                                            <span>{{error}}</span>
                                                        </div><!-- /.form-group -->
                                                    {{else}}
                                                        <strong>
                                                            <strong>{{displayName}}</strong>
                                                        </strong>
                                                    {{/objectProperty}}
                                                </td>
                                            </tr>

                                            <tr>
                                                <td colspan="2">Tags:
                                                    {{#objectProperty property=tags}}
                                                        <span class="badge badge-primary"><i class="fa fa-tag"></i> {{value}}
                                                            {{#if editMode}}
                                                                <i class="remove-tag fa fa-times" style="padding-left: 7px;cursor: pointer;" title="Remove"></i>
                                                            {{/if}}
                                                        </span>
                                                    {{/objectProperty}}
                                                    {{#if editMode}}
                                                        <div class="input-group">
                                                            <input id="new-tag" type="text" class="form-control" placeholder="Enter tags here...">
                                                                <span class="input-group-btn">
                                                                  <button class="add-tag btn btn-success" type="button">Add</button>
                                                                </span>
                                                        </div><!-- /input-group -->
                                                    {{/if}}
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                    
                                </div>
                                <!-- /.box-content-lg-->

                                {{#if editMode}}
                                    <div class="box-header-2" style="height: 60px">
                                        <div class="pull-right">
                                            <span class="btn btn-default cancelButton">
                                                Cancel
                                            </span>
                                            <span class="btn btn-info saveButton">
                                                Save
                                            </span>
                                        </div>
                                    </div>
                                {{/if}}
                            </div>

                            {{> jobDescription}}

                            <div class="row">
                                <div class="col-lg-6">
                                    <!-- /.box -->
                                    {{>assignment}}

                                    {{>jobRates}}
                                </div>
                                <div class="col-lg-6">
                                    {{>customerInfo customer=getCustomer path='customer' collection=jobCollection}}
                                    {{>jobActivity}}
                                </div>
                            </div>
                        </div>
                        <!-- /.col-lg-->

                        <!-- Right Column -->
                        <div class="col-sm-6 col-lg-4 contactable-left-col">
                            {{>job_tabs originalJob=. documentCount=documentCount noteCount=noteCount  }}
                        </div>

                        <div class="col-md-4 col-lg-4">

                        </div>
                        <!-- /.col-lg-4-->
                    </div>
                    <!-- /.container-fluid -->
                </div>
            {{/with}}
        </div>
        <!-- /.content -->
    </div>
</template>

<template name="job_tabs">
    <ul class="nav nav-tabs  contactable-nav-tabs-main bottom-20">
        <li class="active"><a href="#profile-notes" data-toggle="tab">Notes <span class="custom-badge-2">{{noteCount}}</span></a></li>
        <li ><a href="#profile-candidates" data-toggle="tab">Candidates <span class="custom-badge-2">0</span></a></li>

    </ul>

    <div class="tab-content">
        <!-- Notes Tab -->
        <div class="tab-pane active" id="profile-notes">
            {{> contactableNotesAdd entity=job type=getType}}
            {{> contactableNotesList entity=job}}
        </div>

        <div class="tab-pane " id="profile-candidates">
            {{>candidates job=originalJob._id}}
        </div>
    </div>

</template>


<template name="jobDescription"> 
    <div class="box">
        <div class="box-header-2">
            <a class="btn-action editJobDescription pull-right" href="#" style="color: {{colorDescriptionEdit}}"><i class="fa fa-pencil"></i></a>
            <div class="box-title">
                    Description
                    <a class="previewMode hidden-sm hidden-xs" href="#" title="Preview in mobile size" style="margin-left: 4px"><i class="fa fa-mobile-phone" style="float: inherit; margin-top: 2px; color: {{colorPreviewMode}}"></i></a>
            </div>

        </div>
        <div class="box-body">
            <div style="margin-top: 10px; margin-left: 10px"> 
                {{#objectProperty property=jobDescription editable=editMode}}
                        {{#htmlEditor}}
                        {{/htmlEditor}}
                {{else}}
                    <div id="description" style="max-height: 600px; min-height: 100px; overflow-y: auto;">
                        <div class="text">
                            {{#showAsHTML value=value previewMode=previewMode}}
                            {{/showAsHTML}}
                        </div>
                    </div>
                {{/objectProperty}}
                <!-- /.jobDescription -->
            </div>
        </div>
        {{#if editMode}}
            <div class="box-header-2" style="height: 60px">
                <div class="pull-right">
                    <span id="cancelJobDescriptionEdit" class="btn btn-default">
                        Cancel
                    </span>
                    <span id="saveJobDescriptionEdit" class="btn btn-info">
                        Save
                    </span>
                </div>
            </div>
        {{/if}}
    </div>
</template>