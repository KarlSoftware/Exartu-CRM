<template name="jobs">
    <div class="jobs-page">
        <div id="content">
            {{#with information}}
            <div id="content-header" class="mini">
                <h1>
                    {{#objectProperty property=jobsCount }}
                    <strong> {{value}} </strong>
                    {{/objectProperty}}

                    {{#objectProperty property=objType}}
                    {{#if value}}
                    <span> {{value}} </span>
                    {{else}}
                    record(s)
                    {{/if}}
                    {{/objectProperty}}
                </h1>
            </div>
            <div id="breadcrumb">
                <a href="/" title="Go to Home" class="tip-bottom">Home</a>
                <a href="/jobs" class="current">
                    {{#objectProperty property=objType }}
                    <strong> {{value}} </strong>
                    {{/objectProperty}}</a>
            </div>
            {{/with}}

            <div>
                <div class="row">
                    <div class="col-md-3 col-lg-3">
                        <sidebar>
                            {{> jobsFilters }}
                        </sidebar>
                    </div>

                    <div class="col-md-8 col-lg-8">
                        {{>jobsListSearch}}
                    </div>

                    <div class="col-md-9 col-lg-9">
                        {{#if isSearching}}
                        searching
                        {{else}}
                        {{> jobsList }}
                        {{/if}}
                        {{#infinityScroll cb=showMore}} {{/infinityScroll}}
                    </div>
                </div>
                <!--/ko-->
            </div>
        </div>
    </div>
</template>

<template name="jobsFilters">
    <div class="filter">
        <a class="filter-toggle" data-toggle="collapse" href="#filter-body">
            <strong><i class="fa fa-filter"></i></strong>
        </a>

        <div class="filter-list" id="filter-body">

            <div class="filter-item">
                <div class="filter-title">
                    <i class="fa fa-group"></i>
                    Types
                </div>

                {{#each jobTypes2}}
                    <button type="button" class="typeSelect {{typeOptionClass .}}">{{name}}</button>
                {{/each}}
            </div>

            <div class="filter-item">
                <div class="filter-title">
                    Status
                </div>

                {{>lookupFilterTemplate lookUpCode=3 callback=statusChanged multi=false}}
            </div>

            <div class="filter-item">
                <div class="filter-title">
                    <i class="fa fa-eye"></i>
                    Visibility
                </div>

                <button id="show-inactives" type="button" class="{{showInactives}}">Inactives</button>
            </div>

            <div class="filter-item">
                <div class="filter-title">
                    <i class="fa fa-calendar"></i>
                    Creation date
                </div>

                <button type="button" class="{{recentOptionClass recentOptions.day}}" style="margin-bottom: 3px" id="recent-day">Today</button>
                <button type="button" class="{{recentOptionClass recentOptions.week}}" style="margin-bottom: 3px" id="recent-week">This week</button>
                <button type="button" class="{{recentOptionClass recentOptions.month}}" style="margin-bottom: 3px" id="recent-month">This month</button>
                <button type="button" class="{{recentOptionClass recentOptions.year}}" style="margin-bottom: 3px" id="recent-year">This year</button>
            </div>

            <div class="filter-item">
                <div class="filter-title">
                    <i class="fa fa-tags"></i>
                    Tags
                </div>

                <div class="input-group" style="margin-bottom: 10px">
                    <input id="new-tag" type="text" class="form-control" placeholder="E.g. javascript, sales">
                    <span class="input-group-btn">
                      <button class="add-tag btn btn-default" type="button"><span class="fa fa-plus"></span></button>
                    </span>
                </div>

                {{#objectProperty property=tags}}
                    <button type="button" class="tag btn btn-xs btn-info">
                        <span >{{value}}</span>
                        <i class="remove-tag fa fa-times"></i>
                    </button>
                {{/objectProperty}}
            </div>

            <div class="filter-item">
                <div class="filter-title">
                    <i class="fa fa-map-marker"></i>
                    Location
                </div>

                <div class="input-group">
                    {{#objectProperty property=query.location}}
                        <input type="text" class="form-control" placeholder="E.g. city: San Francisco" value="{{value}}">
                    {{/objectProperty}}
                    <span class="input-group-btn">
                      <button class="add-tag btn btn-default" type="button"><span class="fa fa-map-marker"></span></button>
                    </span>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="jobsList">
    <div>
        <!--{{> jobsListSearch }}-->

        {{#each jobs}}
        {{> jobsListItem }}
        {{else}}
        {{#if info.isFiltering.value }}
        <div class="v-wrapper">
            <div class="v-wrapper-cell text-center text-muted" style="height: 678px;">
                <i class="icon-connection-1 text-large"></i>
                <h1>
                    No records Found
                </h1>
            </div><!-- /.v-wrapper-cell -->
        </div>
        {{else}}
        <div class="v-wrapper">
            <div class="v-wrapper-cell text-center text-muted" style="height: 678px;">
                <i class="icon-connection-1 text-large"></i>
                <a href="#" data-bind="attr: { href: '/jobAdd/'+name() }, text: 'New ' + name()"></a>
                <span class="bullet-spacer" data-bind="visible: $index()< $parent.jobTypes().length-1">Â·</span>
            </div><!-- /.v-wrapper-cell -->
        </div>
        {{/if}}
        {{/each}}
    </div>
</template>

<template name="jobsListItem">
    <div class="table-item magic">
        <div class="row ">
            <div class="col-sm-4">
                <div class="table-item-cell">
                    <div class="table-item-cell-container">

                        <div class="table-item-title">
                            <a href="/job/{{_id}}">
                                {{displayName}}</a>
                            <br/>
                        </div>
                    </div>
                    <!-- /.table-item-cell-container -->
                </div>
                <!-- /.table-item-cell -->
            </div>
            <!-- /.col-sm-3 -->
            <div class="col-sm-5">
                <div class="table-item-cell">
                    <div class="table-item-cell-container text-muted">

                        {{> jobInformation }}

                    </div>
                    <!-- /.table-item-cell-container -->
                </div>
                <!-- /.table-item-cell -->
            </div>
            <!-- /.col-sm-4 -->
            <div class="col-sm-3">
                <div class="table-item-cell">
                    <div class="table-item-cell-container date">
                        {{#formattedDate value=dateCreated format='fromNow'}}
                            <span>{{date}}</span>
                        {{/formattedDate}}
                        {{#if searchKey }}
                            <br />
                            <i class="glyphicon glyphicon-search"></i>
                            {{searchKey}}
                        {{/if}}
                    </div>
                </div>
            </div>
        </div>
        <!-- /.row -->
    </div>
    <!-- /.table-item -->
</template>



<template name="jobInformation">
    <i class="icon-building-2"></i>
    <strong><a href="/contactable/{{customer}}">{{customerName}}</a></strong>

    <br/>
    <i class="icon-calendar-2"></i>
    <small>
        {{#formattedDate value=startDate}}
            {{date}}
        {{/formattedDate}}-
        {{#if endDate}}
            {{#formattedDate value=endDate}}
                {{date}}
            {{/formattedDate}}
        {{/if}}
    </small>

    {{#if location.displayName}}
        <br/>
        <i class="icon-map-marker-1"></i>
        {{location.displayName}}
    {{/if}}

    <br/>
    <span class="badge">
        {{lookUpName status}}
    </span>
</template>

<template name="jobsListSearch">
    <div class="actions-head">
        <div class="row">
            <div class="col-sm-8 col-md-8 col-lg-8">

                <div class="pull-left suffix-5">
                    <!-- Single button -->
                    <div class="btn-group">
                        <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" title="Add">
                            <span class="fa fa-plus"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu" data-bind="foreach: jobTypes">
                            {{#each jobTypes}}
                            <li><a href="/jobAdd/{{name}}">Add {{name}}</a></li>
                            {{/each}}
                        </ul>
                    </div>
                </div>

                <div class="input-group">
                    {{#objectProperty property=searchString}}
                    <input type="text" class="form-control" placeholder="Search Jobs" value="{{value}}">
                    {{/objectProperty}}
                    <span class="input-group-btn">
                        <button class="btn btn-primary" type="button">
                            <i class="fa fa-search"></i>
                        </button>
                    </span>
                </div>
            </div><!-- /.col-lg-5 -->
            <div class="pull-right">
                {{> jobsListSort}}
            </div>
        </div><!-- /.row -->
    </div>
</template>

<template name="jobsListSort">
    <div class="btn-group">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Sort by
            {{#with selectedSort}}
                <strong>{{displayName}}</strong>
                {{#if isAscSort .}}
                    <i class="fa fa-sort-amount-asc"> </i>
                {{else}}
                    <i class="fa fa-sort-amount-desc"> </i>
                {{/if}}
            {{/with}}
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
            {{#each sortFields}}
                <li>
                    <a class="sort-field">
                        {{displayName}}
                        {{#if isFieldSelected .}}
                            {{#if isAscSort .}}
                                <i class="fa fa-sort-amount-asc"> </i>
                            {{else}}
                                <i class="fa fa-sort-amount-desc"> </i>
                            {{/if}}
                        {{/if}}
                    </a>
                </li>
            {{/each}}
        </ul>
    </div>
</template>