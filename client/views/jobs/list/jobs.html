<template name="jobs">
    <div id="content">
        {{#with information}}
            <!--<div id="content-header" class="mini">-->
                <!--<h1>-->
                    <!--{{#objectProperty property=jobsCount }}-->
                        <!--<strong> {{value}} </strong>-->
                    <!--{{/objectProperty}}-->

                    <!--{{#objectProperty property=objType}}-->
                        <!--{{#if value}}-->
                            <!--<span> {{value}} </span>-->
                        <!--{{else}}-->
                            <!--jobs-->
                        <!--{{/if}}-->
                    <!--{{/objectProperty}}-->
                <!--</h1>-->
            <!--</div>-->

            <div id="breadcrumb">
                <a href="/" title="Go to Home" class="tip-bottom">Home</a>
                <a href="/jobs" class="current">{{jobsCount.value}} jobs
                </a>
            </div>
        {{/with}}

        <div>
            <div class="row">
                <div class="col-md-3 col-lg-3">
                    <sidebar>
                        {{> jobsFilters }}
                    </sidebar>
                </div>

                <div class="col-md-8 col-lg-8">
                    {{>jobListSearch}}

                </div>


                <div class="col-md-9 col-lg-9">
                    <div>
                        {{>fastPagination name="jobs"}}
                    </div>
                    <div class="fade-in">
                        {{> jobList }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="jobsFilters">
    <div class="filter">
        <a class="filter-toggle" data-toggle="collapse" href="#filter-body">
            <strong><i class="fa fa-filter"></i></strong>
        </a>

        <div class="filter-list" id="filter-body">
            {{> filter_entityType types=jobTypes selected=query.objType}}

            {{> filter_lookUp code=3 lookUpValue=query.status multi=false}}

            {{> filter_inactive showInactive=query.inactives}}

            {{> filter_createdBy showMineOnly=query.mineOnly}}

            {{> filter_createdDate selectedLimit=query.selectedLimit}}

            {{> filter_tags tags=query.tags}}

            {{> filter_location location=query.location}}
        </div>
    </div>
</template>

<template name="jobList">
    {{#if isLoading}}
        <div style="height: 280px;">
        </div>
    {{else}}
        {{#each jobs}}
            {{> jobListItem }}
        {{else}}
            {{#if info.isFiltering.value }}
                <div class="v-wrapper">
                    <div class="v-wrapper-cell text-center text-muted" style="height: 678px;">
                        <i class="icon-connection-1 text-large"></i>

                        <h1>
                            No records Found
                        </h1>
                    </div>
                </div>
            {{else}}
                <div class="v-wrapper">
                    <div class="v-wrapper-cell text-center text-muted" style="height: 678px;">
                        <i class="icon-connection-1 text-large"></i>
                        <a href="#" data-bind="attr: { href: '/jobAdd/'+name() }, text: 'New ' + name()"></a>
                        <span class="bullet-spacer" data-bind="visible: $index()< $parent.jobTypes().length-1">Â·</span>
                    </div>
                </div>
            {{/if}}
        {{/each}}
    {{/if}}
</template>

<template name="jobListItem">
    {{#if listViewMode}}
        <div class="table-item magic">
            <div class="table-item-cell">
                <div class="table-item-cell-container">
                    <div class="table-item-title">
                        <a href="/job/{{_id}}">
                            {{displayName}}
                        </a>
                        <small class="text-muted text-normal">-</small>
                        <strong><a href="/contactable/{{customer}}">{{customerName}}</a></strong>
                        <span class="badge">
                            {{lookUpName status}}
                        </span>
                        <span class="badge">
                            {{lookUpName activeStatus}}
                        </span>
                    <span class="pull-right">
                              <span class="task-author">
                                  {{displayUserName userId}}
                              </span>
                              <span class="task-author">
                                  {{_id}}
                              </span>
                              <span class="task-author">
                                  {{#formattedDate value=dateCreated format='fromNow'}}
                                      {{date}}
                                  {{/formattedDate}}
                              </span>
                    </span>
                    </div>
                </div>
            </div>
        </div>
    {{else}}

        <div class="table-item magic">
            <div class="row ">
                <div class="col-sm-4 col-xs-4">
                    <div class="table-item-cell">
                        <div class="table-item-cell-container">
                            <div class="table-item-title">
                                <a href="/job/{{_id}}">
                                    {{displayName}}
                                </a>
                                <br/>
                                <small class="text-muted text-normal">
                                    {{countPlacements}} placements
                                    {{#each placements}}
                                        <a href="/contactable/{{employee}}">
                                            <span class="badge badge-primary">{{getEmployeeDisplayName}}</span>
                                        </a>
                                    {{/each}}
                                    {{#if morePlacements}}
                                        <a href="/job/{{_id}}#placements"> show all..</a>
                                    {{/if}}
                                </small>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-sm-5 col-xs-5">
                    <div class="table-item-cell">
                        <div class="table-item-cell-container text-muted">
                            {{> jobInformation }}
                        </div>
                    </div>
                </div>

                <div class="col-sm-3 col-xs-3">
                    <div class="table-item-cell">
                        <div class="table-item-cell-container date">
                            {{#formattedDate value=dateCreated format='fromNow'}}
                                <span>{{date}}</span>
                                <br/>
                            {{/formattedDate}}

                            {{displayUserName userId}}

                            {{#if searchKey }}
                                <br/>
                                <i class="glyphicon glyphicon-search"></i>
                                {{searchKey}}
                            {{/if}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {{/if}}
</template>

<template name="jobInformation">
    <i class="icon-building-2"></i>
    <strong><a href="/contactable/{{customer}}">{{customerName}} - {{departmentName}}</a></strong>
    <br/>
    <div class="task-author">
        {{#if location.displayName}}
            <i class="icon-map-marker-1"></i>
            {{location.displayName}}
        {{/if}}
        <span class="badge">
            {{lookUpName status}}
        </span>
                <span class="badge">
                    {{lookUpName activeStatus}}
                </span>
    </div>
</template>

<template name="jobListSearch">
    <div class="actions-head">
        <div class="row visible-xs">
            <div class="col-xs-8">
                <div class="pull-left suffix-5">
                    <div class="btn-group">
                        <a href="/jobAdd/Temporary" type="button" class="btn btn-success" title="Add">
                            <span class="fa fa-plus"></span>
                        </a>
                    </div>
                </div>

                <div class="input-group">
                    {{#objectProperty property=searchString}}
                        <input type="text" class="form-control" placeholder="Search jobs" value="{{value}}">
                    {{/objectProperty}}

                    <span class="input-group-btn">
                        <button class="btn btn-primary" type="button">
                            <i class="fa fa-search"></i>
                        </button>
                    </span>
                </div>
            </div>
            <div class="col-xs-4">
                     <span class="pointer" style="font-size: 20px;">
                         {{#if listViewMode}}
                             <i id="detail-view" class="fa fa-th-large" style="opacity: 0.4"></i>
                            <i class="fa fa-bars"></i>
                         {{else}}
                             <i class="fa fa-th-large"></i>
                            <i id="list-view" class="fa fa-bars" style="opacity: 0.4"></i>
                         {{/if}}
                     </span>
                {{> jobListSort}}
            </div>

        </div>
        <div class="row hidden-xs">
            <div class="col-xs-8 col-sm-8 col-md-8 col-lg-8">
                <div class="pull-left suffix-5">
                    <div class="btn-group">
                        <a href="/jobAdd/Temporary" type="button" class="btn btn-success" title="Add">
                            <span class="fa fa-plus"></span>
                        </a>
                    </div>
                </div>

                <div class="input-group">
                    {{#objectProperty property=searchString}}
                        <input type="text" class="form-control" placeholder="Search jobs" value="{{value}}">
                    {{/objectProperty}}

                    <span class="input-group-btn">
                        <button class="btn btn-primary" type="button">
                            <i class="fa fa-search"></i>
                        </button>
                    </span>
                </div>
            </div>
            <div class="col-sm-2 col-md-2 col-lg-2">
                     <span class="pointer" style="font-size: 20px;">
                         {{#if listViewMode}}
                             <i id="detail-view" class="fa fa-th-large" style="opacity: 0.4"></i>
                            <i class="fa fa-bars"></i>
                         {{else}}
                             <i class="fa fa-th-large"></i>
                            <i id="list-view" class="fa fa-bars" style="opacity: 0.4"></i>
                         {{/if}}
                     </span>
            </div>

            <div class=" col-sm-2 col-md-2 col-lg-2">
                {{> jobListSort}}
            </div>
        </div>
    </div>
</template>

<template name="jobListSort">
    <div class="btn-group">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Sort
            {{#with selectedSort}}
                <strong>{{displayName}}</strong>
                {{#if isAscSort .}}
                    <i class="fa fa-sort-amount-asc"> </i>
                {{else}}
                    <i class="fa fa-sort-amount-desc"> </i>
                {{/if}}
            {{/with}}
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
            {{#each sortFields}}
                <li>
                    <a class="sort-field">
                        {{displayName}}
                        {{#if isFieldSelected .}}
                            {{#if isAscSort .}}
                                <i class="fa fa-sort-amount-asc"> </i>
                            {{else}}
                                <i class="fa fa-sort-amount-desc"> </i>
                            {{/if}}
                        {{/if}}
                    </a>
                </li>
            {{/each}}
        </ul>
    </div>
</template>